<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://robostack.github.io/Contributing.html><link rel=prev href=support.html><link rel=next href=FAQ.html><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>Contributing - RoboStack</title><link rel=stylesheet href=assets/stylesheets/main.6f8fc17f.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=extra.css><script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#contributing class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=index.html title=RoboStack class="md-header__button md-logo" aria-label=RoboStack data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> RoboStack </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Contributing </span> </div> </div> </div> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__source> <a href=https://github.com/RoboStack/robostack.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=index.html title=RoboStack class="md-nav__button md-logo" aria-label=RoboStack data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> RoboStack </label> <div class=md-nav__source> <a href=https://github.com/RoboStack/robostack.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=GettingStarted.html class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Available Packages </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Available Packages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=noetic.html class=md-nav__link> <span class=md-ellipsis> ROS1 Noetic </span> </a> </li> <li class=md-nav__item> <a href=foxy.html class=md-nav__link> <span class=md-ellipsis> ROS2 Foxy </span> </a> </li> <li class=md-nav__item> <a href=galactic.html class=md-nav__link> <span class=md-ellipsis> ROS2 Galactic </span> </a> </li> <li class=md-nav__item> <a href=humble.html class=md-nav__link> <span class=md-ellipsis> ROS2 Humble </span> </a> </li> <li class=md-nav__item> <a href=jazzy.html class=md-nav__link> <span class=md-ellipsis> ROS2 Jazzy </span> </a> </li> <li class=md-nav__item> <a href=kilted.html class=md-nav__link> <span class=md-ellipsis> ROS2 Kilted </span> </a> </li> <li class=md-nav__item> <a href=JupyterRos.html class=md-nav__link> <span class=md-ellipsis> JupyterRos </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=support.html class=md-nav__link> <span class=md-ellipsis> Support </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <a href=Contributing.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=FAQ.html class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/RoboStack/robostack.github.io/edit/master/docs/Contributing.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/RoboStack/robostack.github.io/raw/master/docs/Contributing.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=contributing>Contributing</h1> <p>Many thanks for taking the time to read this and for contributing to RoboStack!</p> <p>This project is in early stages and we are looking for contributors to help it grow.</p> <p>The developers are on the <a href=https://discord.gg/kKV8ZxyzY4><code>robotics</code> channel on <code>prefix.dev</code>'s discord</a> where we discuss steps forward.</p> <p>We welcome all kinds of contribution -- code or non-code -- and value them highly. We pledge to treat everyones contribution fairly and with respect and we are here to help awesome pull requests over the finish line.</p> <p>Please note we have a code of conduct, and follow it in all your interactions with the project.</p> <p>We follow the <a href=https://numfocus.org/code-of-conduct>NumFOCUS code of conduct</a>.</p> <h1 id=adding-new-packages-via-pull-requests>Adding new packages via pull requests</h1> <p>You can open a pull request that will get build automatically in our CI.</p> <p>An example can be found <a href=https://github.com/RoboStack/ros-humble/pull/257>here</a>. </p> <p>Depending on the distribution, you need to add the package either to a unified <code>vinca.yaml</code> file, or to multiple <code>vinca_*.yaml</code> files, where the <code>*</code> indicates the desired platform (<code>linux_64</code>, <code>linux_aarch64</code> (for ARM processors), <code>osx_64</code> (old Intel Macs), <code>osx_arm64</code> (Apple Silicon), or <code>win</code>). For the distributions with a unified <code>vinca.yaml</code> file, a package can be included or excluded by a given platform using <code>rattler-build</code>-style selectors, see https://rattler.build/dev/selectors/ .</p> <p>Ideally, try to add packages to all of these platforms. The name of the package is accepted both with underscores and dashes as word separators, but it is suggested to type the name of the package exactly as https://index.ros.org knows it.</p> <h2 id=creating-a-new-patch-file>Creating a new patch file</h2> <p>Sometimes, it may be required to patch the packages. An example of how to do so can be found in <a href=https://github.com/RoboStack/ros-noetic/pull/32>this PR</a>. Generating the patch can be done as follows:</p> <ol> <li>Modify the <code>vinca_*.yaml</code> file, but just adding the package you want to create the patch for</li> <li>Run <code>pixi run build</code>. This will either succeded it the package can be built without any patch, or fail if a patch is required to actually build the package.</li> <li>Start a shell and go inside the repository to be edited. It should be located in <code>&lt;robostack folder&gt;/output/src_cache/&lt;repo_name&gt;</code>, where <code>&lt;robostack folder&gt;</code> is the folder where you run <code>pixi run build</code> and <code>&lt;repo_name&gt;</code> is the name of the repository associated to the package in the <code>url:</code> attribute of the repo in the <code>rosdistro_snapshot.yaml</code></li> <li>Apply the changes that you would like to store into the patch</li> <li>Create a patch file with <code>git diff &gt; changes.patch</code></li> <li>Check that the patch contains the intended changes</li> <li>Move the file into the <code>patches</code> directory of this repository, renaming it according to the naming convention. If the changes are portable across all supported operating system, the file should be called <code>&lt;package name&gt;.patch</code>; otherwise, <code>&lt;package name&gt;.&lt;win/linux/osx&gt;.patch</code></li> <li>In some cases the <code>recipe.yaml</code> generated needs also a patch (eg. add a conda dependency), in those scenarios a <code>add_host</code> key needs to be added to <code>patch/dependencies.yaml</code> <a href=https://github.com/RoboStack/ros-noetic/blob/bd1d2f44fcbfb02a31c464e51a761fb0fdc32ec0/patch/dependencies.yaml#L15-L17>example</a></li> <li>Rerun <code>pixi run build</code> to ensure that the patching succeeds and the package builds without errors</li> <li>Commit the new file, push to your fork and create a PR</li> </ol> <h2 id=extending-an-existing-patch-file>Extending an existing patch file</h2> <p>The procedure to create a new patch file still applies, with a caveat.</p> <p>The git repository of the package cloned by <code>rattler-build</code> will be in a dirty state. The changes of the working tree should amount to the patches already existing for the package. Running <code>git diff</code> will result in a patch which intermingles the new changes to the old ones. This would allow to just swap the new resulting patch file for the old one, but this may make code review difficult if the order of the hunks changes.</p> <p>To make code review easier, please consider manually porting the new hunks into the existing patch file. This can be made easier by running <code>git reset --hard</code> before applying the new changes to the source code.</p> <h1 id=testing-changes-locally>Testing changes locally</h1> <p>Clone the relevant repo:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/RoboStack/ros-humble.git<span class=w>  </span><span class=c1># or: git clone https://github.com/RoboStack/ros-noetic.git or git clone https://github.com/RoboStack/ros-jazzy.git or git clone https://github.com/RoboStack/ros-kilted.git</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=sb>```</span>bash
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>Then<span class=w> </span>move<span class=w> </span><span class=k>in</span><span class=w> </span>the<span class=w> </span>newly<span class=w> </span>cloned<span class=w> </span>repo,<span class=w> </span>and<span class=w> </span><span class=k>if</span><span class=w> </span>necessary<span class=w> </span><span class=k>do</span><span class=w> </span>any<span class=w> </span>change<span class=w> </span>to<span class=w> </span>the<span class=w> </span><span class=sb>`</span>vinca_*.yaml<span class=sb>`</span><span class=w> </span>file<span class=w> </span><span class=k>for</span><span class=w> </span>your<span class=w> </span>platform:
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=sb>```</span>bash
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=nb>cd</span><span class=w> </span>ros-humble<span class=w>  </span><span class=c1># or: cd ros-noetic or cd ros-jazzy or cd ros-kilted</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=sb>```</span>bash
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=k>then</span><span class=w> </span>you<span class=w> </span>can<span class=w> </span>build<span class=w> </span>the<span class=w> </span>packages<span class=w> </span>that<span class=w> </span>need<span class=w> </span>to<span class=w> </span>be<span class=w> </span>built<span class=w> </span>after<span class=w> </span>the<span class=w> </span><span class=sb>`</span>vinca_***.yaml<span class=sb>`</span><span class=w> </span>changes<span class=w> </span>with:
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=sb>```</span>bash
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>pixi<span class=w> </span>run<span class=w> </span>build
</code></pre></div> <h1 id=how-does-it-work>How does it work?</h1> <ul> <li>The <code>vinca_*.yaml</code> files specify which packages should be built. </li> <li>Add the desired package under <code>packages_select_by_deps</code>. This will automatically pull in all dependencies of that package, too.</li> <li>Note that all packages that are already build in one of the channels listed under <code>skip_existing</code> will be skipped. </li> <li>The <code>packages_remove_from_deps</code> list allows you to never build packages, even if they are listed as dependencies of other packages, by removing them from the dependencies of other packages. We use it for e.g. the stage simulator which is not available in conda-forge, but is listed as one of the dependencies of the ros-simulator metapackage.</li> <li>If you want to rebuild a package (for example because it had a problem for which you added a patch), set it build number explicitly in the <code>pkg_additional_info.yaml</code> file. Note that this will not update the package, unless the <code>rosdistro_snapshot.yaml</code> file is also updated (and that typically happens only for full rebuild)</li> <li>The <code>robostack.yaml</code> and <code>packages-ignore.yaml</code> files are the equivalent of the <a href=http://wiki.ros.org/rosdep/rosdep.yaml>rosdep.yaml</a> and translate ROS dependencies into conda package names (or in the case of the dependencies listed in <code>packages-ignore.yaml</code> the dependencies are ignored by specifying an empty list).</li> </ul> <h1 id=doing-a-full-rebuild>Doing a full rebuild</h1> <p>A "full rebuild" is a rebuild of all packages for a given distro, that is typically done to update the version of ROS packages contained in a RoboStack channel, and to build against new versions of dependencies provided by conda-forge.</p> <p>When doing a full rebuild, please follow these guidelines:</p> <ul> <li>Refresh the <code>rosdistro_snapshot.yaml</code> by running <code>vinca snapshot</code> (this is the only step that actually queries rosdistro, directly from the repo and independently from sync).</li> <li>Refresh the <code>conda_build_config.yaml</code> file to reflect the current status of conda-forge plus migrations that are basically finished even if not updated in conda-forge-pinnings (see https://conda-forge.org/status/ for a list of ongoing migrations and their status; if in doubt, please ask the RoboStack maintainers).</li> <li>Bump the <code>build_number</code> in <code>vinca_*.yaml</code> files to a version higher than any existing build number (considering the overriden build numbers in <code>pkg_additional_info.yaml</code>).</li> <li>Bump the minor number of the mutex_package in <code>vinca_*.yaml</code>, and manually search for any hardcoded number for <code>ros-distro-mutex</code> or <code>ros2-distro-mutex</code> in <code>additional_recipes</code></li> <li>Remove any <code>build_number</code> override in <code>pkg_additional_info.yaml</code>.</li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": ".", "features": ["content.code.copy", "content.action.edit", "content.action.view", "content.tabs.link", "navigation.instant", "navigation.path"], "search": "assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=assets/javascripts/bundle.88dd0f4e.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src=javascripts/tables.js></script> </body> </html>